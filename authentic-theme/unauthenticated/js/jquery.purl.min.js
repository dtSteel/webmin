/*! PURL.js v2.3.1 https://github.com/allmarkedup/purl */
(function(b){if(typeof define==="function"&&define.amd){define(b)}else{window.purl=b()}})(function(){var A={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href",embed:"src",object:"data"},u=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],F={anchor:"fragment"},H={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},C=/^[0-9]+$/;function D(f,c){var a=decodeURI(f),d=H[c||false?"strict":"loose"].exec(a),b={attr:{},param:{},seg:{}},e=14;while(e--){b.attr[u[e]]=d[e]||""}b.param.query=z(b.attr.query);b.param.fragment=z(b.attr.fragment);b.seg.path=b.attr.path.replace(/^\/+|\/+$/g,"").split("/");b.seg.fragment=b.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");b.attr.base=b.attr.host?(b.attr.protocol?b.attr.protocol+"://"+b.attr.host:b.attr.host)+(b.attr.port?":"+b.attr.port:""):"";return b}function G(a){var b=a.tagName;if(typeof b!=="undefined"){return A[b.toLowerCase()]}return b}function r(a,b){if(a[b].length===0){return a[b]={}}var c={};for(var d in a[b]){c[d]=a[b][d]}a[b]=c;return c}function E(b,d,e,a){var f=b.shift();if(!f){if(B(d[e])){d[e].push(a)}else{if("object"==typeof d[e]){d[e]=a}else{if("undefined"==typeof d[e]){d[e]=a}else{d[e]=[d[e],a]}}}}else{var c=d[e]=d[e]||[];if("]"==f){if(B(c)){if(""!==a){c.push(a)}}else{if("object"==typeof c){c[s(c).length]=a}else{c=d[e]=[d[e],a]}}}else{if(~f.indexOf("]")){f=f.substr(0,f.length-1);if(!C.test(f)&&B(c)){c=r(d,e)}E(b,c,f,a)}else{if(!C.test(f)&&B(c)){c=r(d,e)}E(b,c,f,a)}}}}function x(c,d,a){if(~d.indexOf("]")){var b=d.split("[");E(b,c,"base",a)}else{if(!C.test(d)&&B(c.base)){var e={};for(var f in c.base){e[f]=c.base[f]}c.base=e}if(d!==""){w(c.base,d,a)}}return c}function z(a){return y(String(a).split(/&|;/),function(g,b){try{b=decodeURIComponent(b)}catch(e){}var h=b.indexOf("="),c=t(b),f=b.substr(0,c||h),d=b.substr(c||h,b.length);d=d.substr(d.indexOf("=")+1,d.length);if(f===""){f=b;d=""}return x(g,f,d)},{base:{}}).base}function w(b,c,a){var d=b[c];if(typeof d==="undefined"){b[c]=a}else{if(B(d)){d.push(a)}else{b[c]=[d,a]}}}function t(b){var e=b.length,c,a;for(var d=0;d<e;++d){a=b[d];if("]"==a){c=false}if("["==a){c=true}if("="==a&&!c){return d}}}function y(a,d){var c=0,e=a.length>>0,b=arguments[2];while(c<e){if(c in a){b=d.call(undefined,b,a[c],c,a)}++c}return b}function B(a){return Object.prototype.toString.call(a)==="[object Array]"}function s(b){var c=[];for(var a in b){if(b.hasOwnProperty(a)){c.push(a)}}return c}function v(b,a){if(arguments.length===1&&b===true){a=true;b=undefined}a=a||false;b=b||window.location.toString();return{data:D(b,a),attr:function(c){c=F[c]||c;return typeof c!=="undefined"?this.data.attr[c]:this.data.attr},param:function(c){return typeof c!=="undefined"?this.data.param.query[c]:this.data.param.query},fparam:function(c){return typeof c!=="undefined"?this.data.param.fragment[c]:this.data.param.fragment},segment:function(c){if(typeof c==="undefined"){return this.data.seg.path}else{c=c<0?this.data.seg.path.length+c:c-1;return this.data.seg.path[c]}},fsegment:function(c){if(typeof c==="undefined"){return this.data.seg.fragment}else{c=c<0?this.data.seg.fragment.length+c:c-1;return this.data.seg.fragment[c]}}}}v.jQuery=function(a){if(a!=null){a.fn.url=function(b){var c="";if(this.length){c=a(this).attr(G(this[0]))||""}return v(c,b)};a.url=v}};v.jQuery(window.jQuery);return v});
/*! URI.js v1.18.9 http://medialize.github.io/URI.js/ */
(function(a,b){"object"===typeof module&&module.exports?module.exports=b():"function"===typeof define&&define.amd?define(b):a.IPv6=b(a)})(this,function(a){var b=a&&a.IPv6;return{best:function(j){j=j.toLowerCase().split(":");var i=j.length,o=8;""===j[0]&&""===j[1]&&""===j[2]?(j.shift(),j.shift()):""===j[0]&&""===j[1]?j.shift():""===j[i-1]&&""===j[i-2]&&j.pop();i=j.length;-1!==j[i-1].indexOf(".")&&(o=7);var c;for(c=0;c<i&&""!==j[c];c++){}if(c<o){for(j.splice(c,1,"0000");j.length<o;){j.splice(c,0,"0000")}}for(c=0;c<o;c++){for(var i=j[c].split(""),e=0;3>e;e++){if("0"===i[0]&&1<i.length){i.splice(0,1)}else{break}}j[c]=i.join("")}var i=-1,q=e=0,k=-1,g=!1;for(c=0;c<o;c++){g?"0"===j[c]?q+=1:(g=!1,q>e&&(i=k,e=q)):"0"===j[c]&&(g=!0,k=c,q=1)}q>e&&(i=k,e=q);1<e&&j.splice(i,e,"");i=j.length;o="";""===j[0]&&(o=":");for(c=0;c<i;c++){o+=j[c];if(c===i-1){break}o+=":"}""===j[i-1]&&(o+=":");return o},noConflict:function(){a.IPv6===this&&(a.IPv6=b);return this}}});(function(a,b){"object"===typeof module&&module.exports?module.exports=b(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"===typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],b):a.URI=b(a.punycode,a.IPv6,a.SecondLevelDomains,a)})(this,function(V,S,X,W){function Z(e,d){var h=1<=arguments.length,f=2<=arguments.length;if(!(this instanceof Z)){return h?f?new Z(e,d):new Z(e):new Z}if(void 0===e){if(h){throw new TypeError("undefined is not a valid argument for URI")}e="undefined"!==typeof location?location.href+"":""}if(null===e&&h){throw new TypeError("null is not a valid argument for URI")}this.href(e);return void 0!==d?this.absoluteTo(d):this}function U(d){return d.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function r(d){return void 0===d?"Undefined":String(Object.prototype.toString.call(d)).slice(8,-1)}function T(d){return"Array"===r(d)}function Q(f,e){var m={},l,h;if("RegExp"===r(e)){m=null}else{if(T(e)){for(l=0,h=e.length;l<h;l++){m[e[l]]=!0}}else{m[e]=!0}}l=0;for(h=f.length;l<h;l++){if(m&&void 0!==m[f[l]]||!m&&e.test(f[l])){f.splice(l,1),h--,l--}}return f}function M(f,e){var m,l;if(T(e)){m=0;for(l=e.length;m<l;m++){if(!M(f,e[m])){return !1}}return !0}var h=r(e);m=0;for(l=f.length;m<l;m++){if("RegExp"===h){if("string"===typeof f[m]&&f[m].match(e)){return !0}}else{if(f[m]===e){return !0}}}return !1}function O(f,e){if(!T(f)||!T(e)||f.length!==e.length){return !1}f.sort();e.sort();for(var l=0,h=f.length;l<h;l++){if(f[l]!==e[l]){return !1}}return !0}function c(d){return d.replace(/^\/+|\/+$/g,"")}function L(d){return escape(d)}function a(d){return encodeURIComponent(d).replace(/[!'()*]/g,L).replace(/\*/g,"%2A")}function k(d){return function(e,f){if(void 0===e){return this._parts[d]||""}this._parts[d]=e||null;this.build(!f);return this}}function N(e,d){return function(h,f){if(void 0===h){return this._parts[e]||""}null!==h&&(h+="",h.charAt(0)===d&&(h=h.substring(1)));this._parts[e]=h;this.build(!f);return this}}var K=W&&W.URI;Z.version="1.18.9";var Y=Z.prototype,P=Object.prototype.hasOwnProperty;Z._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:Z.duplicateQueryParameters,escapeQuerySpace:Z.escapeQuerySpace}};Z.duplicateQueryParameters=!1;Z.escapeQuerySpace=!0;Z.protocol_expression=/^[a-z][a-z0-9.+-]*$/i;Z.idn_expression=/[^a-z0-9\.-]/i;Z.punycode_expression=/(xn--)/i;Z.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;Z.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;Z.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/ig;Z.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u201e\u2018\u2019]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g};Z.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"};Z.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;Z.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"};Z.getDomAttribute=function(e){if(e&&e.nodeName){var d=e.nodeName.toLowerCase();if("input"!==d||"image"===e.type){return Z.domAttributes[d]}}};Z.encode=a;Z.decode=decodeURIComponent;Z.iso8859=function(){Z.encode=escape;Z.decode=unescape};Z.unicode=function(){Z.encode=a;Z.decode=decodeURIComponent};Z.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}};Z.encodeQuery=function(e,d){var f=Z.encode(e+"");void 0===d&&(d=Z.escapeQuerySpace);return d?f.replace(/%20/g,"+"):f};Z.decodeQuery=function(e,d){e+="";void 0===d&&(d=Z.escapeQuerySpace);try{return Z.decode(d?e.replace(/\+/g,"%20"):e)}catch(f){return e}};var s={encode:"encode",decode:"decode"},i,R=function(e,d){return function(h){try{return Z[d](h+"").replace(Z.characters[e][d].expression,function(l){return Z.characters[e][d].map[l]})}catch(f){return h}}};for(i in s){Z[i+"PathSegment"]=R("pathname",s[i]),Z[i+"UrnPathSegment"]=R("urnpath",s[i])}s=function(e,d,f){return function(l){var h;h=f?function(p){return Z[d](Z[f](p))}:Z[d];l=(l+"").split(e);for(var n=0,m=l.length;n<m;n++){l[n]=h(l[n])}return l.join(e)}};Z.decodePath=s("/","decodePathSegment");Z.decodeUrnPath=s(":","decodeUrnPathSegment");Z.recodePath=s("/","encodePathSegment","decode");Z.recodeUrnPath=s(":","encodeUrnPathSegment","decode");Z.encodeReserved=R("reserved","encode");Z.parse=function(e,d){var f;d||(d={});f=e.indexOf("#");-1<f&&(d.fragment=e.substring(f+1)||null,e=e.substring(0,f));f=e.indexOf("?");-1<f&&(d.query=e.substring(f+1)||null,e=e.substring(0,f));"//"===e.substring(0,2)?(d.protocol=null,e=e.substring(2),e=Z.parseAuthority(e,d)):(f=e.indexOf(":"),-1<f&&(d.protocol=e.substring(0,f)||null,d.protocol&&!d.protocol.match(Z.protocol_expression)?d.protocol=void 0:"//"===e.substring(f+1,f+3)?(e=e.substring(f+3),e=Z.parseAuthority(e,d)):(e=e.substring(f+1),d.urn=!0)));d.path=e;return d};Z.parseHost=function(f,e){f=f.replace(/\\/g,"/");var m=f.indexOf("/"),l;-1===m&&(m=f.length);if("["===f.charAt(0)){l=f.indexOf("]"),e.hostname=f.substring(1,l)||null,e.port=f.substring(l+2,m)||null,"/"===e.port&&(e.port=null)}else{var h=f.indexOf(":");l=f.indexOf("/");h=f.indexOf(":",h+1);-1!==h&&(-1===l||h<l)?(e.hostname=f.substring(0,m)||null,e.port=null):(l=f.substring(0,m).split(":"),e.hostname=l[0]||null,e.port=l[1]||null)}e.hostname&&"/"!==f.substring(m).charAt(0)&&(m++,f="/"+f);return f.substring(m)||"/"};Z.parseAuthority=function(e,d){e=Z.parseUserinfo(e,d);return Z.parseHost(e,d)};Z.parseUserinfo=function(e,d){var h=e.indexOf("/"),f=e.lastIndexOf("@",-1<h?h:e.length-1);-1<f&&(-1===h||f<h)?(h=e.substring(0,f).split(":"),d.username=h[0]?Z.decode(h[0]):null,h.shift(),d.password=h[0]?Z.decode(h.join(":")):null,e=e.substring(f+1)):(d.username=null,d.password=null);return e};Z.parseQuery=function(l,d){if(!l){return{}}l=l.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!l){return{}}for(var u={},p=l.split("&"),m=p.length,t,q,n=0;n<m;n++){if(t=p[n].split("="),q=Z.decodeQuery(t.shift(),d),t=t.length?Z.decodeQuery(t.join("="),d):null,P.call(u,q)){if("string"===typeof u[q]||null===u[q]){u[q]=[u[q]]}u[q].push(t)}else{u[q]=t}}return u};Z.build=function(e){var d="";e.protocol&&(d+=e.protocol+":");e.urn||!d&&!e.hostname||(d+="//");d+=Z.buildAuthority(e)||"";"string"===typeof e.path&&("/"!==e.path.charAt(0)&&"string"===typeof e.hostname&&(d+="/"),d+=e.path);"string"===typeof e.query&&e.query&&(d+="?"+e.query);"string"===typeof e.fragment&&e.fragment&&(d+="#"+e.fragment);return d};Z.buildHost=function(e){var d="";if(e.hostname){d=Z.ip6_expression.test(e.hostname)?d+("["+e.hostname+"]"):d+e.hostname}else{return""}e.port&&(d+=":"+e.port);return d};Z.buildAuthority=function(d){return Z.buildUserinfo(d)+Z.buildHost(d)};Z.buildUserinfo=function(e){var d="";e.username&&(d+=Z.encode(e.username));e.password&&(d+=":"+Z.encode(e.password));d&&(d+="@");return d};Z.buildQuery=function(l,d,u){var p="",m,t,q,n;for(t in l){if(P.call(l,t)&&t){if(T(l[t])){for(m={},q=0,n=l[t].length;q<n;q++){void 0!==l[t][q]&&void 0===m[l[t][q]+""]&&(p+="&"+Z.buildQueryParameter(t,l[t][q],u),!0!==d&&(m[l[t][q]+""]=!0))}}else{void 0!==l[t]&&(p+="&"+Z.buildQueryParameter(t,l[t],u))}}}return p.substring(1)};Z.buildQueryParameter=function(e,d,f){return Z.encodeQuery(e,f)+(null!==d?"="+Z.encodeQuery(d,f):"")};Z.addQuery=function(e,d,h){if("object"===typeof d){for(var f in d){P.call(d,f)&&Z.addQuery(e,f,d[f])}}else{if("string"===typeof d){void 0===e[d]?e[d]=h:("string"===typeof e[d]&&(e[d]=[e[d]]),T(h)||(h=[h]),e[d]=(e[d]||[]).concat(h))}else{throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")}}};Z.removeQuery=function(e,d,h){var f;if(T(d)){for(h=0,f=d.length;h<f;h++){e[d[h]]=void 0}}else{if("RegExp"===r(d)){for(f in e){d.test(f)&&(e[f]=void 0)}}else{if("object"===typeof d){for(f in d){P.call(d,f)&&Z.removeQuery(e,f,d[f])}}else{if("string"===typeof d){void 0!==h?"RegExp"===r(h)?!T(e[d])&&h.test(e[d])?e[d]=void 0:e[d]=Q(e[d],h):e[d]!==String(h)||T(h)&&1!==h.length?T(e[d])&&(e[d]=Q(e[d],h)):e[d]=void 0:e[d]=void 0}else{throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter")}}}}};Z.hasQuery=function(f,d,n,l){switch(r(d)){case"String":break;case"RegExp":for(var h in f){if(P.call(f,h)&&d.test(h)&&(void 0===n||Z.hasQuery(f,h,n))){return !0}}return !1;case"Object":for(var m in d){if(P.call(d,m)&&!Z.hasQuery(f,m,d[m])){return !1}}return !0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(r(n)){case"Undefined":return d in f;case"Boolean":return f=!(T(f[d])?!f[d].length:!f[d]),n===f;case"Function":return !!n(f[d],d,f);case"Array":return T(f[d])?(l?M:O)(f[d],n):!1;case"RegExp":return T(f[d])?l?M(f[d],n):!1:!(!f[d]||!f[d].match(n));case"Number":n=String(n);case"String":return T(f[d])?l?M(f[d],n):!1:f[d]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}};Z.joinPaths=function(){for(var f=[],d=[],n=0,l=0;l<arguments.length;l++){var h=new Z(arguments[l]);f.push(h);for(var h=h.segment(),m=0;m<h.length;m++){"string"===typeof h[m]&&d.push(h[m]),h[m]&&n++}}if(!d.length||!n){return new Z("")}d=(new Z("")).segment(d);""!==f[0].path()&&"/"!==f[0].path().slice(0,1)||d.path("/"+d.path());return d.normalize()};Z.commonPath=function(f,e){var l=Math.min(f.length,e.length),h;for(h=0;h<l;h++){if(f.charAt(h)!==e.charAt(h)){h--;break}}if(1>h){return f.charAt(0)===e.charAt(0)&&"/"===f.charAt(0)?"/":""}if("/"!==f.charAt(h)||"/"!==e.charAt(h)){h=f.substring(0,h).lastIndexOf("/")}return f.substring(0,h+1)};Z.withinString=function(E,D,C){C||(C={});var z=C.start||Z.findUri.start,B=C.end||Z.findUri.end,A=C.trim||Z.findUri.trim,y=C.parens||Z.findUri.parens,w=/[a-z0-9-]=["']?$/i;for(z.lastIndex=0;;){var x=z.exec(E);if(!x){break}var v=x.index;if(C.ignoreHtml){var u=E.slice(Math.max(v-3,0),v);if(u&&w.test(u)){continue}}for(var d=v+E.slice(v).search(B),u=E.slice(v,d),d=-1;;){var t=y.exec(u);if(!t){break}d=Math.max(d,t.index+t[0].length)}u=-1<d?u.slice(0,d)+u.slice(d).replace(A,""):u.replace(A,"");u.length<=x[0].length||C.ignore&&C.ignore.test(u)||(d=v+u.length,x=D(u,v,d,E),void 0===x?z.lastIndex=d:(x=String(x),E=E.slice(0,v)+x+E.slice(d),z.lastIndex=v+x.length))}z.lastIndex=0;return E};Z.ensureValidHostname=function(d){if(d.match(Z.invalid_hostname_characters)){if(!V){throw new TypeError('Hostname "'+d+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available')}if(V.toASCII(d).match(Z.invalid_hostname_characters)){throw new TypeError('Hostname "'+d+'" contains characters other than [A-Z0-9.-]')}}};Z.noConflict=function(d){if(d){return d={URI:this.noConflict()},W.URITemplate&&"function"===typeof W.URITemplate.noConflict&&(d.URITemplate=W.URITemplate.noConflict()),W.IPv6&&"function"===typeof W.IPv6.noConflict&&(d.IPv6=W.IPv6.noConflict()),W.SecondLevelDomains&&"function"===typeof W.SecondLevelDomains.noConflict&&(d.SecondLevelDomains=W.SecondLevelDomains.noConflict()),d}W.URI===this&&(W.URI=K);return this};Y.build=function(d){if(!0===d){this._deferred_build=!0}else{if(void 0===d||this._deferred_build){this._string=Z.build(this._parts),this._deferred_build=!1}}return this};Y.clone=function(){return new Z(this)};Y.valueOf=Y.toString=function(){return this.build(!1)._string};Y.protocol=k("protocol");Y.username=k("username");Y.password=k("password");Y.hostname=k("hostname");Y.port=k("port");Y.query=N("query","?");Y.fragment=N("fragment","#");Y.search=function(e,d){var f=this.query(e,d);return"string"===typeof f&&f.length?"?"+f:f};Y.hash=function(e,d){var f=this.fragment(e,d);return"string"===typeof f&&f.length?"#"+f:f};Y.pathname=function(e,d){if(void 0===e||!0===e){var f=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?Z.decodeUrnPath:Z.decodePath)(f):f}this._parts.path=this._parts.urn?e?Z.recodeUrnPath(e):"":e?Z.recodePath(e):"/";this.build(!d);return this};Y.path=Y.pathname;Y.href=function(f,d){var m;if(void 0===f){return this.toString()}this._string="";this._parts=Z._parts();var h=f instanceof Z,l="object"===typeof f&&(f.hostname||f.path||f.pathname);f.nodeName&&(l=Z.getDomAttribute(f),f=f[l]||"",l=!1);!h&&l&&void 0!==f.pathname&&(f=f.toString());if("string"===typeof f||f instanceof String){this._parts=Z.parse(String(f),this._parts)}else{if(h||l){for(m in h=h?f._parts:f,h){P.call(this._parts,m)&&(this._parts[m]=h[m])}}else{throw new TypeError("invalid input")}}this.build(!d);return this};Y.is=function(x){var w=!1,v=!1,t=!1,u=!1,q=!1,p=!1,d=!1,f=!this._parts.urn;this._parts.hostname&&(f=!1,v=Z.ip4_expression.test(this._parts.hostname),t=Z.ip6_expression.test(this._parts.hostname),w=v||t,q=(u=!w)&&X&&X.has(this._parts.hostname),p=u&&Z.idn_expression.test(this._parts.hostname),d=u&&Z.punycode_expression.test(this._parts.hostname));switch(x.toLowerCase()){case"relative":return f;case"absolute":return !f;case"domain":case"name":return u;case"sld":return q;case"ip":return w;case"ip4":case"ipv4":case"inet4":return v;case"ip6":case"ipv6":case"inet6":return t;case"idn":return p;case"url":return !this._parts.urn;case"urn":return !!this._parts.urn;case"punycode":return d}return null};var o=Y.protocol,j=Y.port,g=Y.hostname;Y.protocol=function(e,d){if(void 0!==e&&e&&(e=e.replace(/:(\/\/)?$/,""),!e.match(Z.protocol_expression))){throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]")}return o.call(this,e,d)};Y.scheme=Y.protocol;Y.port=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0!==e&&(0===e&&(e=null),e&&(e+="",":"===e.charAt(0)&&(e=e.substring(1)),e.match(/[^0-9]/)))){throw new TypeError('Port "'+e+'" contains characters other than [0-9]')}return j.call(this,e,d)};Y.hostname=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0!==e){var f={};if("/"!==Z.parseHost(e,f)){throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]')}e=f.hostname}return g.call(this,e,d)};Y.origin=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){var f=this.protocol();return this.authority()?(f?f+"://":"")+this.authority():""}f=Z(e);this.protocol(f.protocol()).authority(f.authority()).build(!d);return this};Y.host=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){return this._parts.hostname?Z.buildHost(this._parts):""}if("/"!==Z.parseHost(e,this._parts)){throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]')}this.build(!d);return this};Y.authority=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){return this._parts.hostname?Z.buildAuthority(this._parts):""}if("/"!==Z.parseAuthority(e,this._parts)){throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]')}this.build(!d);return this};Y.userinfo=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){var f=Z.buildUserinfo(this._parts);return f?f.substring(0,f.length-1):f}"@"!==e[e.length-1]&&(e+="@");Z.parseUserinfo(e,this._parts);this.build(!d);return this};Y.resource=function(e,d){var f;if(void 0===e){return this.path()+this.search()+this.hash()}f=Z.parse(e);this._parts.path=f.path;this._parts.query=f.query;this._parts.fragment=f.fragment;this.build(!d);return this};Y.subdomain=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){if(!this._parts.hostname||this.is("IP")){return""}var f=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,f)||""}f=this._parts.hostname.length-this.domain().length;f=this._parts.hostname.substring(0,f);f=new RegExp("^"+U(f));e&&"."!==e.charAt(e.length-1)&&(e+=".");e&&Z.ensureValidHostname(e);this._parts.hostname=this._parts.hostname.replace(f,e);this.build(!d);return this};Y.domain=function(e,d){if(this._parts.urn){return void 0===e?"":this}"boolean"===typeof e&&(d=e,e=void 0);if(void 0===e){if(!this._parts.hostname||this.is("IP")){return""}var f=this._parts.hostname.match(/\./g);if(f&&2>f.length){return this._parts.hostname}f=this._parts.hostname.length-this.tld(d).length-1;f=this._parts.hostname.lastIndexOf(".",f-1)+1;return this._parts.hostname.substring(f)||""}if(!e){throw new TypeError("cannot set domain empty")}Z.ensureValidHostname(e);!this._parts.hostname||this.is("IP")?this._parts.hostname=e:(f=new RegExp(U(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(f,e));this.build(!d);return this};Y.tld=function(e,d){if(this._parts.urn){return void 0===e?"":this}"boolean"===typeof e&&(d=e,e=void 0);if(void 0===e){if(!this._parts.hostname||this.is("IP")){return""}var f=this._parts.hostname.lastIndexOf("."),f=this._parts.hostname.substring(f+1);return !0!==d&&X&&X.list[f.toLowerCase()]?X.get(this._parts.hostname)||f:f}if(e){if(e.match(/[^a-zA-Z0-9-]/)){if(X&&X.is(e)){f=new RegExp(U(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(f,e)}else{throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]')}}else{if(!this._parts.hostname||this.is("IP")){throw new ReferenceError("cannot set TLD on non-domain host")}f=new RegExp(U(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(f,e)}}else{throw new TypeError("cannot set TLD empty")}this.build(!d);return this};Y.directory=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname){return""}if("/"===this._parts.path){return"/"}var f=this._parts.path.length-this.filename().length-1,f=this._parts.path.substring(0,f)||(this._parts.hostname?"/":"");return e?Z.decodePath(f):f}f=this._parts.path.length-this.filename().length;f=this._parts.path.substring(0,f);f=new RegExp("^"+U(f));this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e));e&&"/"!==e.charAt(e.length-1)&&(e+="/");e=Z.recodePath(e);this._parts.path=this._parts.path.replace(f,e);this.build(!d);return this};Y.filename=function(e,d){if(this._parts.urn){return void 0===e?"":this}if("string"!==typeof e){if(!this._parts.path||"/"===this._parts.path){return""}var h=this._parts.path.lastIndexOf("/"),h=this._parts.path.substring(h+1);return e?Z.decodePathSegment(h):h}h=!1;"/"===e.charAt(0)&&(e=e.substring(1));e.match(/\.?\//)&&(h=!0);var f=new RegExp(U(this.filename())+"$");e=Z.recodePath(e);this._parts.path=this._parts.path.replace(f,e);h?this.normalizePath(d):this.build(!d);return this};Y.suffix=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path){return""}var h=this.filename(),f=h.lastIndexOf(".");if(-1===f){return""}h=h.substring(f+1);h=/^[a-z0-9%]+$/i.test(h)?h:"";return e?Z.decodePathSegment(h):h}"."===e.charAt(0)&&(e=e.substring(1));if(h=this.suffix()){f=e?new RegExp(U(h)+"$"):new RegExp(U("."+h)+"$")}else{if(!e){return this}this._parts.path+="."+Z.recodePath(e)}f&&(e=Z.recodePath(e),this._parts.path=this._parts.path.replace(f,e));this.build(!d);return this};Y.segment=function(m,l,u){var t=this._parts.urn?":":"/",q=this.path(),p="/"===q.substring(0,1),q=q.split(t);void 0!==m&&"number"!==typeof m&&(u=l,l=m,m=void 0);if(void 0!==m&&"number"!==typeof m){throw Error('Bad segment "'+m+'", must be 0-based integer')}p&&q.shift();0>m&&(m=Math.max(q.length+m,0));if(void 0===l){return void 0===m?q:q[m]}if(null===m||void 0===q[m]){if(T(l)){q=[];m=0;for(var n=l.length;m<n;m++){if(l[m].length||q.length&&q[q.length-1].length){q.length&&!q[q.length-1].length&&q.pop(),q.push(c(l[m]))}}}else{if(l||"string"===typeof l){l=c(l),""===q[q.length-1]?q[q.length-1]=l:q.push(l)}}}else{l?q[m]=c(l):q.splice(m,1)}p&&q.unshift("");return this.path(q.join(t),u)};Y.segmentCoded=function(f,d,m){var l,h;"number"!==typeof f&&(m=d,d=f,f=void 0);if(void 0===d){f=this.segment(f,d,m);if(T(f)){for(l=0,h=f.length;l<h;l++){f[l]=Z.decode(f[l])}}else{f=void 0!==f?Z.decode(f):void 0}return f}if(T(d)){for(l=0,h=d.length;l<h;l++){d[l]=Z.encode(d[l])}}else{d="string"===typeof d||d instanceof String?Z.encode(d):d}return this.segment(f,d,m)};var b=Y.query;Y.query=function(f,d){if(!0===f){return Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace)}if("function"===typeof f){var l=Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace),h=f.call(this,l);this._parts.query=Z.buildQuery(h||l,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);this.build(!d);return this}return void 0!==f&&"string"!==typeof f?(this._parts.query=Z.buildQuery(f,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!d),this):b.call(this,f,d)};Y.setQuery=function(f,d,m){var l=Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"===typeof f||f instanceof String){l[f]=void 0!==d?d:null}else{if("object"===typeof f){for(var h in f){P.call(f,h)&&(l[h]=f[h])}}else{throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")}}this._parts.query=Z.buildQuery(l,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof f&&(m=d);this.build(!m);return this};Y.addQuery=function(f,d,l){var h=Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace);Z.addQuery(h,f,void 0===d?null:d);this._parts.query=Z.buildQuery(h,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof f&&(l=d);this.build(!l);return this};Y.removeQuery=function(f,d,l){var h=Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace);Z.removeQuery(h,f,d);this._parts.query=Z.buildQuery(h,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof f&&(l=d);this.build(!l);return this};Y.hasQuery=function(f,d,l){var h=Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return Z.hasQuery(h,f,d,l)};Y.setSearch=Y.setQuery;Y.addSearch=Y.addQuery;Y.removeSearch=Y.removeQuery;Y.hasSearch=Y.hasQuery;Y.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()};Y.normalizeProtocol=function(d){"string"===typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!d));return this};Y.normalizeHostname=function(d){this._parts.hostname&&(this.is("IDN")&&V?this._parts.hostname=V.toASCII(this._parts.hostname):this.is("IPv6")&&S&&(this._parts.hostname=S.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!d));return this};Y.normalizePort=function(d){"string"===typeof this._parts.protocol&&this._parts.port===Z.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!d));return this};Y.normalizePath=function(h){var d=this._parts.path;if(!d){return this}if(this._parts.urn){return this._parts.path=Z.recodeUrnPath(this._parts.path),this.build(!h),this}if("/"===this._parts.path){return this}var d=Z.recodePath(d),p,n="",l,m;"/"!==d.charAt(0)&&(p=!0,d="/"+d);if("/.."===d.slice(-3)||"/."===d.slice(-2)){d+="/"}d=d.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/");p&&(n=d.substring(1).match(/^(\.\.\/)+/)||"")&&(n=n[0]);for(;;){l=d.search(/\/\.\.(\/|$)/);if(-1===l){break}else{if(0===l){d=d.substring(3);continue}}m=d.substring(0,l).lastIndexOf("/");-1===m&&(m=l);d=d.substring(0,m)+d.substring(l+3)}p&&this.is("relative")&&(d=n+d.substring(1));this._parts.path=d;this.build(!h);return this};Y.normalizePathname=Y.normalizePath;Y.normalizeQuery=function(d){"string"===typeof this._parts.query&&(this._parts.query.length?this.query(Z.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!d));return this};Y.normalizeFragment=function(d){this._parts.fragment||(this._parts.fragment=null,this.build(!d));return this};Y.normalizeSearch=Y.normalizeQuery;Y.normalizeHash=Y.normalizeFragment;Y.iso8859=function(){var e=Z.encode,d=Z.decode;Z.encode=escape;Z.decode=decodeURIComponent;try{this.normalize()}finally{Z.encode=e,Z.decode=d}return this};Y.unicode=function(){var e=Z.encode,d=Z.decode;Z.encode=a;Z.decode=unescape;try{this.normalize()}finally{Z.encode=e,Z.decode=d}return this};Y.readable=function(){var l=this.clone();l.username("").password("").normalize();var d="";l._parts.protocol&&(d+=l._parts.protocol+"://");l._parts.hostname&&(l.is("punycode")&&V?(d+=V.toUnicode(l._parts.hostname),l._parts.port&&(d+=":"+l._parts.port)):d+=l.host());l._parts.hostname&&l._parts.path&&"/"!==l._parts.path.charAt(0)&&(d+="/");d+=l.path(!0);if(l._parts.query){for(var t="",q=0,m=l._parts.query.split("&"),p=m.length;q<p;q++){var n=(m[q]||"").split("="),t=t+("&"+Z.decodeQuery(n[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"));void 0!==n[1]&&(t+="="+Z.decodeQuery(n[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}d+="?"+t.substring(1)}return d+=Z.decodeQuery(l.hash(),!0)};Y.absoluteTo=function(h){var d=this.clone(),n=["protocol","username","password","hostname","port"],m,l;if(this._parts.urn){throw Error("URNs do not have any generally defined hierarchical components")}h instanceof Z||(h=new Z(h));if(d._parts.protocol){return d}d._parts.protocol=h._parts.protocol;if(this._parts.hostname){return d}for(m=0;l=n[m];m++){d._parts[l]=h._parts[l]}d._parts.path?(".."===d._parts.path.substring(-2)&&(d._parts.path+="/"),"/"!==d.path().charAt(0)&&(n=(n=h.directory())?n:0===h.path().indexOf("/")?"/":"",d._parts.path=(n?n+"/":"")+d._parts.path,d.normalizePath())):(d._parts.path=h._parts.path,d._parts.query||(d._parts.query=h._parts.query));d.build();return d};Y.relativeTo=function(h){var d=this.clone().normalize(),n,m,l;if(d._parts.urn){throw Error("URNs do not have any generally defined hierarchical components")}h=(new Z(h)).normalize();n=d._parts;m=h._parts;l=d.path();h=h.path();if("/"!==l.charAt(0)){throw Error("URI is already relative")}if("/"!==h.charAt(0)){throw Error("Cannot calculate a URI relative to another relative URI")}n.protocol===m.protocol&&(n.protocol=null);if(n.username===m.username&&n.password===m.password&&null===n.protocol&&null===n.username&&null===n.password&&n.hostname===m.hostname&&n.port===m.port){n.hostname=null,n.port=null}else{return d.build()}if(l===h){return n.path="",d.build()}l=Z.commonPath(l,h);if(!l){return d.build()}m=m.path.substring(l.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");n.path=m+n.path.substring(l.length)||"./";return d.build()};Y.equals=function(l){var d=this.clone(),q=new Z(l),p;l={};var n,m;d.normalize();q.normalize();if(d.toString()===q.toString()){return !0}n=d.query();p=q.query();d.query("");q.query("");if(d.toString()!==q.toString()||n.length!==p.length){return !1}d=Z.parseQuery(n,this._parts.escapeQuerySpace);p=Z.parseQuery(p,this._parts.escapeQuerySpace);for(m in d){if(P.call(d,m)){if(!T(d[m])){if(d[m]!==p[m]){return !1}}else{if(!O(d[m],p[m])){return !1}}l[m]=!0}}for(m in p){if(P.call(p,m)&&!l[m]){return !1}}return !0};Y.duplicateQueryParameters=function(d){this._parts.duplicateQueryParameters=!!d;return this};Y.escapeQuerySpace=function(d){this._parts.escapeQuerySpace=!!d;return this};return Z});