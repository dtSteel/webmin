(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("tiddlywiki",function(){var r={};var i={allTags:true,closeAll:true,list:true,newJournal:true,newTiddler:true,permaview:true,saveChanges:true,search:true,slider:true,tabs:true,tag:true,tagging:true,tags:true,tiddler:true,timeline:true,today:true,version:true,option:true,"with":true,filter:true};var t=/[\w_\-]/i,m=/^\-\-\-\-+$/,g=/^\/\*\*\*$/,b=/^\*\*\*\/$/,o=/^<<<$/,f=/^\/\/\{\{\{$/,q=/^\/\/\}\}\}$/,l=/^<!--\{\{\{-->$/,w=/^<!--\}\}\}-->$/,s=/^\{\{\{$/,j=/^\}\}\}$/,e=/.*?\}\}\}/;function n(A,z,y){z.tokenize=y;return y(A,z)}function x(B,A){var z=B.sol(),y=B.peek();A.block=false;if(z&&/[<\/\*{}\-]/.test(y)){if(B.match(s)){A.block=true;return n(B,A,p)}if(B.match(o)){return"quote"}if(B.match(g)||B.match(b)){return"comment"}if(B.match(f)||B.match(q)||B.match(l)||B.match(w)){return"comment"}if(B.match(m)){return"hr"}}B.next();if(z&&/[\/\*!#;:>|]/.test(y)){if(y=="!"){B.skipToEnd();return"header"}if(y=="*"){B.eatWhile("*");return"comment"}if(y=="#"){B.eatWhile("#");return"comment"}if(y==";"){B.eatWhile(";");return"comment"}if(y==":"){B.eatWhile(":");return"comment"}if(y==">"){B.eatWhile(">");return"quote"}if(y=="|"){return"header"}}if(y=="{"&&B.match(/\{\{/)){return n(B,A,p)}if(/[hf]/i.test(y)&&/[ti]/i.test(B.peek())&&B.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return"link"}if(y=='"'){return"string"}if(y=="~"){return"brace"}if(/[\[\]]/.test(y)&&B.match(y)){return"brace"}if(y=="@"){B.eatWhile(t);return"link"}if(/\d/.test(y)){B.eatWhile(/\d/);return"number"}if(y=="/"){if(B.eat("%")){return n(B,A,c)}else{if(B.eat("/")){return n(B,A,u)}}}if(y=="_"&&B.eat("_")){return n(B,A,d)}if(y=="-"&&B.eat("-")){if(B.peek()!=" "){return n(B,A,v)}if(B.peek()==" "){return"brace"}}if(y=="'"&&B.eat("'")){return n(B,A,h)}if(y=="<"&&B.eat("<")){return n(B,A,k)}B.eatWhile(/[\w\$_]/);return r.propertyIsEnumerable(B.current())?"keyword":null}function c(B,A){var y=false,z;while(z=B.next()){if(z=="/"&&y){A.tokenize=x;break}y=(z=="%")}return"comment"}function h(B,A){var y=false,z;while(z=B.next()){if(z=="'"&&y){A.tokenize=x;break}y=(z=="'")}return"strong"}function p(z,y){var A=y.block;if(A&&z.current()){return"comment"}if(!A&&z.match(e)){y.tokenize=x;return"comment"}if(A&&z.sol()&&z.match(j)){y.tokenize=x;return"comment"}z.next();return"comment"}function u(B,A){var y=false,z;while(z=B.next()){if(z=="/"&&y){A.tokenize=x;break}y=(z=="/")}return"em"}function d(B,A){var y=false,z;while(z=B.next()){if(z=="_"&&y){A.tokenize=x;break}y=(z=="_")}return"underlined"}function v(B,A){var y=false,z;while(z=B.next()){if(z=="-"&&y){A.tokenize=x;break}y=(z=="-")}return"strikethrough"}function k(A,z){if(A.current()=="<<"){return"macro"}var y=A.next();if(!y){z.tokenize=x;return null}if(y==">"){if(A.peek()==">"){A.next();z.tokenize=x;return"macro"}}A.eatWhile(/[\w\$_]/);return i.propertyIsEnumerable(A.current())?"keyword":null}return{startState:function(){return{tokenize:x}},token:function(A,z){if(A.eatSpace()){return null}var y=z.tokenize(A,z);return y}}});a.defineMIME("text/x-tiddlywiki","tiddlywiki")});