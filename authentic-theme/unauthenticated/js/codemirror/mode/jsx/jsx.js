(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],a)}else{a(CodeMirror)}}})(function(b){function a(e,g,f,d){this.state=e;this.mode=g;this.depth=f;this.prev=d}function c(d){return new a(b.copyState(d.mode,d.state),d.mode,d.depth,d.prev&&c(d.prev))}b.defineMode("jsx",function(f,j){var h=b.getMode(f,{name:"xml",allowMissing:true,multilineTagIndentPastTag:false});var i=b.getMode(f,j&&j.base||"javascript");function d(n){var m=n.tagName;n.tagName=null;var l=h.indent(n,"");n.tagName=m;return l}function g(m,l){if(l.context.mode==h){return e(m,l,l.context)}else{return k(m,l,l.context)}}function e(s,q,m){if(m.depth==2){if(s.match(/^.*?\*\//)){m.depth=1}else{s.skipToEnd()}return"comment"}if(s.peek()=="{"){h.skipAttribute(m.state);var l=d(m.state),p=m.state.context;if(p&&s.match(/^[^>]*>\s*$/,false)){while(p.prev&&!p.startOfLine){p=p.prev}if(p.startOfLine){l-=f.indentUnit}else{if(m.prev.state.lexical){l=m.prev.state.lexical.indented}}}else{if(m.depth==1){l+=f.indentUnit}}q.context=new a(b.startState(i,l),i,0,q.context);return null}if(m.depth==1){if(s.peek()=="<"){h.skipAttribute(m.state);q.context=new a(b.startState(h,d(m.state)),h,0,q.context);return null}else{if(s.match("//")){s.skipToEnd();return"comment"}else{if(s.match("/*")){m.depth=2;return g(s,q)}}}}var o=h.token(s,m.state),r=s.current(),n;if(/\btag\b/.test(o)){if(/>$/.test(r)){if(m.state.context){m.depth=0}else{q.context=q.context.prev}}else{if(/^</.test(r)){m.depth=1}}}else{if(!o&&(n=r.indexOf("{"))>-1){s.backUp(r.length-n)}}return o}function k(p,n,l){if(p.peek()=="<"&&i.expressionAllowed(p,l.state)){i.skipExpression(l.state);n.context=new a(b.startState(h,i.indent(l.state,"")),h,0,n.context);return null}var m=i.token(p,l.state);if(!m&&l.depth!=null){var o=p.current();if(o=="{"){l.depth++}else{if(o=="}"){if(--l.depth==0){n.context=n.context.prev}}}}return m}return{startState:function(){return{context:new a(b.startState(i),i)}},copyState:function(l){return{context:c(l.context)}},token:g,indent:function(n,l,m){return n.context.mode.indent(n.context.state,l,m)},innerMode:function(l){return l.context}}},"xml","javascript");b.defineMIME("text/jsx","jsx");b.defineMIME("text/typescript-jsx",{name:"jsx",base:{name:"javascript",typescript:true}})});