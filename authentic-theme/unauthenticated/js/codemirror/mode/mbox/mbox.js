(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(d){var a=["From","Sender","Reply-To","To","Cc","Bcc","Message-ID","In-Reply-To","References","Resent-From","Resent-Sender","Resent-To","Resent-Cc","Resent-Bcc","Resent-Message-ID","Return-Path","Received"];var f=["Date","Subject","Comments","Keywords","Resent-Date"];d.registerHelper("hintWords","mbox",a.concat(f));var b=/^[ \t]/;var i=/^From /;var g=new RegExp("^("+a.join("|")+"): ");var e=new RegExp("^("+f.join("|")+"): ");var h=/^[^:]+:/;var m=/^[^ ]+@[^ ]+/;var c=/^.*?(?=[^ ]+?@[^ ]+)/;var n=/^<.*?>/;var j=/^.*?(?=<.*>)/;function l(o){if(o==="Subject"){return"header"}return"string"}function k(s,r){if(s.sol()){r.inSeparator=false;if(r.inHeader&&s.match(b)){return null}else{r.inHeader=false;r.header=null}if(s.match(i)){r.inHeaders=true;r.inSeparator=true;return"atom"}var p;var o=false;if((p=s.match(e))||(o=true)&&(p=s.match(g))){r.inHeaders=true;r.inHeader=true;r.emailPermitted=o;r.header=p[1];return"atom"}if(r.inHeaders&&(p=s.match(h))){r.inHeader=true;r.emailPermitted=true;r.header=p[1];return"atom"}r.inHeaders=false;s.skipToEnd();return null}if(r.inSeparator){if(s.match(m)){return"link"}if(s.match(c)){return"atom"}s.skipToEnd();return"atom"}if(r.inHeader){var q=l(r.header);if(r.emailPermitted){if(s.match(n)){return q+" link"}if(s.match(j)){return q}}s.skipToEnd();return q}s.skipToEnd();return null}d.defineMode("mbox",function(){return{startState:function(){return{inSeparator:false,inHeader:false,emailPermitted:false,header:null,inHeaders:false}},token:k,blankLine:function(o){o.inHeaders=o.inSeparator=o.inHeader=false}}});d.defineMIME("application/mbox","mbox")});